# kmeans

## Задача
Загрузить видеофайл в виде массива кадров. Задать n - число базовых оттенков (8<=n<=32), которые будут использоваться для визуализации каждого кадра. Для каждого из кадров выполнить кластеризацию алгоритмом K-Means цветовых компонент пикселей на n -кластеров. Заменить цвета каждого пикселя цветовыми компонентами центроида кластера, к которому принадлежит пиксель. Результат сохранить в виде последовательности кадров (видео, или набор изображений).

## Используемое железо
Операционная система: Windows 11 Pro, Версия 10.0.22631

Версия среды выполнения DirectX: DirectX 12

Видеокарта:
Графический процессор: NVIDIA GeForce RTX 4070

Уровень возможностей Direct3D: 12_1

Ядра CUDA: 5888

Тактовая частота графической подсистемы: 2505 МГц

Панель изменяемого размера: Нет

Скорость передачи данных памяти: 21.00 Гбит/с

Интерфейс памяти: 192 бит

Пропускная способность памяти: 504.048 ГБ/с

Доступная графическая память: 28630 МБ

Выделенная видеопамять: 12282 МБ GDDR6X

Системная видеопамять: 0 МБ

Общая системная память: 16348 МБ

Драйвер: Драйвер Game Ready - 551.76 - Mar 5, 2024

Дисплей: 1920x1080,144Hz

ЦП: AMD Ryzen 7 5800X3D 8-Core Processor           

Объем ОЗУ: 32.0 GB

Хранилище: SSD - 931.5 GB

## Логика работы
Этот проект содержит программу на Python для обработки видеофайлов, в которой применяется алгоритм K-Means для кластеризации цветовых компонент пикселей на заданное число кластеров. Результатом является видеофайл, в котором каждый кадр обработан с заменой цветов каждого пикселя на цвета центроидов кластеров.

Конечная цель этого кода - преобразовать каждый кадр видеофайла, загруженного из input_file, применяя алгоритм K-Means для кластеризации цветовых компонент пикселей на заданное число кластеров n_clusters. Затем заменить цвета каждого пикселя цветовыми компонентами центроида кластера, к которому принадлежит пиксель. Результат сохраняется в виде последовательности кадров в файл output_file.

## Как это работает

1. Импорт библиотек:
  Используются библиотеки:
  OpenCV (cv2) для работы с изображениями и видео.
  NumPy (numpy) для работы с массивами и матрицами.
  KMeans из sklearn.cluster для реализации алгоритма кластеризации K-Means.

2. Определение функции process_frame:
  Принимает кадр видео и число кластеров n_clusters.
  Преобразует изображение в формат RGB.
  Каждый пиксель преобразуется в одномерный массив.
  Применяется алгоритм K-Means для кластеризации цветовых компонент пикселей.
  Цвета пикселей заменяются на цвета центров кластеров.
  Обработанный кадр возвращается в исходные размеры.

3. Определение функции process_video:
  Принимает путь к входному видеофайлу, путь для сохранения выходного видеофайла и число кластеров.
  Видеофайл открывается с помощью cv2.VideoCapture.
  Получаются параметры видео: количество кадров, частота кадров, ширина и высота кадров.
  Создается объект cv2.VideoWriter для записи выходного видео.
  В цикле каждый кадр видео обрабатывается с помощью process_frame.
  Обработанный кадр записывается в выходной файл.
  По завершении работы все ресурсы освобождаются.
  
  4. Основная часть программы:
  Задается путь к входному и выходному видеофайлу, а также число базовых оттенков.
  Вызывается функция process_video для обработки видео.

## Техническая часть 
## Установка

Для работы требуется Python 3.10+. Скопируйте проект и установите зависимости:

```
pip install -r sys.txt
```
Запустите программу, указав путь к входному видеофайлу, путь для сохранения выходного видеофайла и число кластеров.

  input_video.mp4 - это ваше видео,
  output_video.mp4 - это уже обработанное видео.
Замените название под ваше видео. 
  
![image](https://github.com/sdv301/kmeans/assets/68203784/86233ec0-4a07-49ec-8b58-f69c3f057fdc)


## Примеры работ

  1. Формат мр4 Ширина кадра 320 Высота кадра 236  Качество 240 Длительность 1 секунда 
![image](https://github.com/sdv301/kmeans/assets/68203784/ca700f6e-671e-44c8-97df-71cc13a4ebee)
     После работы кода, можно заметить измения что цвет картинки потускнел и пропал звук при включении. Обратаботка произшла довольно быстро. Но из недостаков можно заметить, что за 1 секунду сложно рассмотреть весь спект измениний, поэтому требуется больше тестов.

  2. Формат мр4 Ширина кадра 1280 Высота кадра 720  Качество 720 Длительность 7 секунда


https://github.com/sdv301/kmeans/assets/68203784/c0b598bd-7bdb-496e-8657-8dc927a081c5


  На обработку 7 секунд прошло очень много времени, если сравнивать с предедущем тестом. Также как и с предыдущим тестом пропал звук, но теперь можно рассмотреть более детально работу. Видно, что замена пикс
    




